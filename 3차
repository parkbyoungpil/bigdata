#%%
import pandas as pd
import numpy as np

mpg = pd.read_excel(r"C:\Users\user\Downloads\dfdata\mpg.xlsx")

mpg.query('category == "suv"')\
    .assign(total = (mpg['hwy']+mpg['cty'] )/2)\
    .groupby('manufacturer')\
    .agg(mean_tot = ('total','mean'))\
    .sort_values('mean_tot', ascending = False)\
    .head()
